[["index.html", "AnVIL Demos About this Series Upcoming AnVIL Events AnVIL Collection", " AnVIL Demos June 14, 2023 About this Series Welcome to our series of demos introducing the Genomic Data Science Analysis, Visualization, and Informatics Lab-space (AnVIL) of the National Human Genome Research Institute (NHGRI). The AnVIL is a cloud-based platform designed to provide researchers with secure and controlled access to genomic data, as well as tools for analysis and visualization. With the increasing availability of genomic data, there is a growing need for efficient and effective tools for data analysis and interpretation. The AnVIL platform addresses this need by providing researchers with easy access to a growing collection of genomic data, as well as powerful tools for analysis and visualization. Our series of demos will guide you through the various features of the AnVIL platform, and show you how it can help you to accelerate your research and make new discoveries in the field of genomics. Whether you are new to the field of genomics or an experienced researcher, these demos will provide you with valuable insights into the AnVIL platform and its capabilities. We look forward to helping you unlock the full potential of genomic data science through the AnVIL platform. Learn more about AnVIL by visiting https://anvilproject.org or reading the article in Cell Genomics. Upcoming AnVIL Events We’d love to see you at an upcoming event! Here are a few upcoming events that might meet your training needs: Date Event Location Jun 2023 AnVIL Demos: How to use data across multiple AnVIL workspaces Virtual Jul 2023 Galaxy Community Conference 2023 Brisbane, Australia Jul 2023 AnVIL Demos: Interactive Genomic Data Science with Bioconductor Virtual Nov 2023 American Society of Human Genetics 2023 Walter E. Washington Convention Center, 801 Mt Vernon Pl NW, Washington, DC 20001 Dec 2023 CSHL Genome Informatics 2023 Cold Spring Harbor, NY, USA AnVIL Collection Please check out our full collection of AnVIL and related resources: https://hutchdatascience.org/AnVIL_Collection/ "],["overview.html", "1 Overview 1.1 Background 1.2 About this Demo 1.3 Skills Level 1.4 Learning Objectives", " 1 Overview 1.1 Background Over the past 20 years, there has been tremendous growth in human genomics, with millions of human genomes sequenced and many more to come in the future. This data, along with other biomedical information, has the potential to greatly improve our understanding of healthy living and transform healthcare. To achieve these goals, we need new approaches to research that involve cloud computing, which is the only way to effectively share and analyze data at this scale. The traditional method of genomic data sharing through centralized data warehouses is becoming unsustainable and inefficient. It creates redundant infrastructure and administrative inefficiencies that make collaborative analysis challenging, especially as datasets increase in size. This approach also leads to high transfer and download costs and poses security and compliance risks. The NHGRI Genomic Data Science Analysis, Visualization, and Informatics Lab-Space, or AnVIL, inverts the traditional model, providing a cloud environment for the analysis of large genomic and related datasets. By providing a secure, unified environment for data management and compute, AnVIL eliminates the need for data movement, allows for active threat detection and monitoring, and provides elastic, shared computing resources that can be acquired as needed. AnVIL currently provides secure access to hundreds of thousands of NHGRI datasets spanning nearly 5 petabytes of data and is built from a set of established components that are accessed and connected through the AnVIL Portal at https://anvilproject.org/ . The AnVIL homepage provides researchers an entry point into these tools, along with documentation, data browser, and links to related resources. 1.2 About this Demo The Welcome to AnVIL demo provides an overview of the AnVIL platform, its purpose, and how it can benefit researchers and the broader genomics community. We highlight some of the historic challenges of analyzing and sharing large-scale genomic data and describe how AnVIL provides a cloud-based solution for accessing and analyzing such data. We also cover key features and functionalities of AnVIL, including its compatibility with popular analysis tools/ Finally, we emphasize the importance of collaboration and community engagement in driving AnVIL’s development and future growth, providing resources to customize your journey with AnVIL. 1.3 Skills Level Genetics Novice: no genetics knowledge needed Programming skills Novice: no programming experience needed 1.4 Learning Objectives Understand the benefits of using cloud computing for genomic data analysis and the limitations of traditional data-sharing paradigms. Identify the main features and tools available on the AnVIL platform and their potential applications in genomics research. Learn how to navigate and access a Workspace, the starting point for a basic analysis using the AnVIL tools. Identify potential use cases for the AnVIL platform in your own research projects. Learn about additional resources to self-guide your discovery on AnVIL. "],["preparation.html", "2 Preparation 2.1 Watch Video", " 2 Preparation 2.1 Watch Video Learn about why AnVIL has been created, what features AnVIL offers, how AnVIL is being used, and how to get started in this ~20 min video (slides) "],["exercises.html", "3 Exercises 3.1 Exercise 1: Launch Terra 3.2 Exercise 2: Clone HPRC Workspace 3.3 Exercise 3: Start a Cloud Environment 3.4 Exercise 4: Find Tidbits 3.5 Exercise 5: Enter Terminal 3.6 Exercise 6: Shut Down", " 3 Exercises 3.1 Exercise 1: Launch Terra 3.2 Exercise 2: Clone HPRC Workspace 3.3 Exercise 3: Start a Cloud Environment 3.4 Exercise 4: Find Tidbits 3.5 Exercise 5: Enter Terminal 3.6 Exercise 6: Shut Down "],["instructor-guide.html", "4 Instructor Guide 4.1 Timeline", " 4 Instructor Guide 4.1 Timeline Activity Duration Introduction 3 minutes Why AnVIL 5 minutes What is AnVIL 7 minutes Use Cases 3 minutes Getting Started 2 minutes Q &amp; A 10 minutes Total 30 minutes "],["scale-with-workflows-overview.html", "5 Overview 5.1 Skills Level 5.2 Learning Objectives", " 5 Overview One of the great features of AnVIL is that it “brings the analysis to the data”. Rather than downloading and storing your own copy of an AnVIL dataset, you can simply create links to the existing data, and run analyses using those links. Here is a video overview of this demo (slides). 5.1 Skills Level Genetics Novice: no genetics knowledge needed Programming skills Novice: no programming experience needed 5.2 Learning Objectives Identify interesting datasets in the AnVIL Dataset Catalog Navigate an AnVIL Workspace Combine data from multiple existing datasets into your own Workspace Find Workflows in Dockstore Run a Workflow on AnVIL with your combined data "],["scale-with-workflows-preparation.html", "6 Preparation 6.1 Watch Video 6.2 Create AnVIL account 6.3 Clone Workspace 6.4 Start Cloud Environment", " 6 Preparation If you plan to follow along with these exercises, there are a couple of things you will need to take care of first: 6.1 Watch Video This 5-min video provides a high level summary of the exercises to follow. Several important concepts are introduced to provide context for the exercises including 1) the AnVIL data flow that minimizes costs and redundancy and 2) increasing number of production quality workflows in Dockstore (slides). 6.2 Create AnVIL account You will need an AnVIL account in order to view Workspaces and run analyses. If you do not already have an account, follow these instructions to set one up. (You do not need to link any external accounts for these exercises.) Make sure that your Instructor (if participating in a workshop) or PI / Lab Manager has your username, so that they can add you to an appropriate Billing Project. You can’t clone or create Workspaces on AnVIL without a Billing Project. 6.3 Clone Workspace When you “clone” a copy of an AnVIL Workspace, it can take a few minutes for everything to propagate to your new Workspace. If you are participating in a course or workshop, your instructor may have you start by cloning the Workspace, so that it is ready by the time you need it. (If you are working at your own pace, feel free to come back to this step later, when you’re ready to start using the Workspace.) Follow the instructions below to clone your own copy of the Workspace for this Demo. This will not work until your instructor has given you permission to spend money to “rent” the computers that will power your analyses (by adding you to a “Billing Project”). On AnVIL, you access files and computers through Workspaces. Each Workspace functions almost like a mini code laboratory - it is a place where data can be examined, stored, and analyzed. The first thing we want to do is to copy or “clone” a Workspace to create a space for you to experiment. This will give you access to the files you will need (data, code) the computing environment you will use Tip At this point, it might make things easier to open up a new window in your browser and split your screen. That way, you can follow along with this guide on one side and execute the steps on the other. To clone an AnVIL Workspace: Open Terra - use a web browser to go to anvil.terra.bio In the drop-down menu on the left, navigate to “Workspaces”. Click the triple bar in the top left corner to access the menu. Click “Workspaces”. You are automatically directed to the “MY WORKSPACES” tab. Here you can see any Workspaces that have been shared with you, along with your permission level. Depending on how your instructor has set things up, you may or may not see any Workspaces in this tab. Locate the Workspace demos-combine-data-workspaces. (The images below show the SARS-CoV-2-Genome Workspace as an example, but you should look for the Workspace demos-combine-data-workspaces.) If it has been shared with you ahead of time, it will appear in “MY WORKSPACES”. Otherwise, select the “PUBLIC” tab. In the top search bar, type the Workspace name demos-combine-data-workspaces. You can also go directly to the Workspace by clicking this link: https://anvil.terra.bio/#workspaces/anvil-outreach/demos-combine-data-workspaces. Clone the workspace by clicking the teardrop button (). Select “Clone”. Or, if you have opened the Workspace, you can find the teardrop button on the top right of the Workspace. You will see a popup box appear, asking you to configure your Workspace Give your Workspace clone a name by adding an underscore (“_“) and your name. For example, \"demos-combine-data-workspaces_Firstname_Lastname\". Select the Billing Project provided by your instructor. Leave the bottom two boxes as-is. Click “CLONE WORKSPACE”. The new Workspace should now show up under “MY WORKSPACES”. You now have your own copy of the Workspace to work in. Now your Workspace should be ready for you by the time you need it below. You are ready to begin! 6.4 Start Cloud Environment "],["scale-with-workflows-exercises.html", "7 Exercises 7.1 Explore Dataset Catalog 7.2 Explore 1000G Workspace 7.3 Combine Data Workspace 7.4 Explore Dockstore Workflows 7.5 Run qc-analysis-pipeline", " 7 Exercises The following exercises will walk you through the process of finding datasets that are stored in AnVIL Workspaces and bringing that data into your own Workspace so that you can analyze it. To follow along with these exercises, you will need to complete the steps described in the Preparation guide for this demo. 7.1 Explore Dataset Catalog First we will take a look at the AnVIL Dataset Catalog. Here you can browse the datasets available on AnVIL. Exercise Use a web browser to navigate to anvilproject.org/data/ and answer the following questions. Q1. Which Consortium has the most participants? You can click on a column name to sort by that column. Click again to switch between ascending and descending. Q2. Where would you find data from the Genotype-Tissue Expression (GTEx) Project? You can use the filters on the left to find specific datasets. Click on either the Consortium or the Study filter to search for GTEx data. Q3. How many Workspaces have consent code NRES (No REStrictions on data use)? You can use the filters on the left to browse and narrow down on datasets that fit your needs. Click on the Consent Code filter to select for datasets that you can access. Now you know how to find AnVIL datasets! To access the data in these datasets, you will need to access the Terra Workspace where the data is stored. You can find links to the Terra Workspaces in the Workspaces tab. Note that, if a Workspace contains protected data, you will need to obtain the appropriate permissions before you can open the Workspace. For these GTEx datasets, AnVIL_GTEx_public_data (with consent code NRES) is available to anyone on AnVIL, but other GTEx Workspaces require permission to access. 7.2 Explore 1000G Workspace Next we will explore one of the Workspaces from the AnVIL Dataset Catalog, so you can see where the data lives. For this exercise, we will look at data from the 1000 Genomes Project. You can find the Workspace that contains the data by searching for the “1000G” Consortium in the AnVIL Dataset Catalog and clicking on the Terra Workspace link, or you can navigate there directly through this link: https://anvil.terra.bio/#workspaces/anvil-datastorage/1000G-high-coverage-2019. 7.2.1 What is a Workspace? Workspaces are the building blocks of projects in Terra. Inside a Workspace, you can run analyses, launch interactive tools like RStudio and Galaxy, store data, and share results. The 1000G-high-coverage-2019 Workspace is being used to store and share data from the 1000 Genomes Project. Note that, since you are only a “Reader”, you will be unable to do any computations directly in this Workspace. To run analyses, you will need a Workspace of your own. Workspaces can serve different purposes. For example, it’s often useful to use one Workspace just for organizing primary data, and then to carry out analyses in a separate Workspace. Storing data in a standalone Workspace helps keep it clean and organized, since it won’t get cluttered up with results and intermediate files from your analyses. It also ensures you can easily see and manage who has access to the data, and allows multiple AnVIL users to use the data without getting in each others’ way. 7.2.2 Dashboard When you first open a Workspace, you will be directed to the Dashboard tab. The Dashboard is like a README for the Workspace - it should contain information to help you understand the purpose and organization of the Workspace. On the right, you can see some basic information about the Workspace such as the usernames of the Owners as well as your permission level for the Workspace. The left side typically contains a description of the Workspace’s contents and purpose. Exercise Q1. What versions of BWA-MEM and GATK were used to process the 1000 Genomes data? Look through the Workspace’s description to see what information has been provided about the data in this Workspace. 7.2.3 Data The Data tab contains all the files associated with the Workspace - data, metadata, workflow outputs, etc. Terra provides Data Tables to help organize data and results. Exercise Take a minute to look through the Data Tables for the 1000G-high-coverage-2019 Workspace. Q2. What types of files are linked to in the Data Table named sample? Q3. What quality control statistics are available in the Data Table named qc_results_sample? A key feature of Terra is that Data Tables can link to files in other Workspaces or even files that live outside of Terra. This means that you don’t need to maintain your own copy of AnVIL datasets; you can simply link to the data from a Data Table within your own Workspace to use it in your workflows. 7.3 Combine Data Workspace Next we will go over how to set up a Data Table so that you can use data from another Workspace in your own analysis. For this exercise, you will need your own copy of the shorts-combine-data-workspaces Workspace. If you have not already done so, follow the instructions in the Preparation section to clone a copy of the Workspace now. 7.3.1 Open your Workspace To get started, navigate to your cloned copy of shorts-combine-data-workspaces. You can find your Workspace in Terra by clicking on “Workspaces” in the dropdown menu, or you can go there directly at anvil.terra.bio/#workspaces. Once there, you should see your Workspace under the “MY WORKSPACES” tab. It may also show up in your recently viewed Workspaces. Click on the Workspace name to open it. Make sure you are in your copy of the Workspace. If you are in the original Workspace, you will not have permission to start up Jupyter and run commands. 7.3.2 Open Jupyter Notebook There are multiple ways to manage Data Tables on AnVIL; for this exercise we will use the Anvil R package, which we will run using a Jupyter cloud environment. The AnVIL package provides a wide range of functions for programmatically interacting with AnVIL. To help you get started, we have provided a copy of a Jupyter Notebook that uses the AnVIL package to create Data Tables linking out to data in another Workspace. For this exercise, you will make a couple of adjustments to the Notebook, so that it links properly to your Workspace (instead of the original Workspace). Within your Workspace, the ANALYSIS tab holds your Notebooks (Jupyter and R Markdown). By clicking on a Notebook, you can preview a static copy of the Notebook. Clicking the “OPEN” button launches the Notebook in a cloud environment so that you can edit and run code. (The “PLAYGROUND” option also lets you edit and run code, but your changes will not be saved.) Exercise In your Workspace, navigate to the “ANALYSIS” tab. Click on combine-data-workspaces.ipynb to view the Notebook for this exercise, and click the “Open” button so you can edit and run it. The Notebook will launch quickly if you already have a Jupyter Cloud Environment set up. If Jupyter is not already set up, the configuration menu will appear. The default settings are fine for this exercise, so scroll to the bottom and click “Create”. It will take a few minutes for Jupyter to start up. This Notebook has four code cells that you will run, after making some edits. 7.3.3 Load Packages The first code cell loads R packages that are needed for this exercise. You do not need to make any adjustments here. Exercise 1. Click on the code cell under “Load Packages”, then click the Run button to load the packages. You should see some messages appear below the cell. 7.3.4 Retrieve original file locations The next two cells find the links to the original data. Here we are bringing in data from two different Workspaces, 1000G-AMR and 1000G-EAS, which contains 1000 Genomes Project data from the Americas and East Asia, respectively. avworkspace( \"anvil-outreach/1000G-AMR\" ) tells the AnVIL package what Workspace to access df_sample_amr &lt;- avtable( \"sample\" ) %&gt;% top_n( -2 ) tells it to look at the table named “sample” and to grab the bottom two samples. It’s often a good idea to start off a new analysis by working with just a few samples. This can help you minimize wasted time and computing expenses while you figure out your pipeline, and can also help you estimate what your costs will be for processing larger dataset before committing to a large Workflow run. To keep this exercise short and cheap, we’re just importing a few samples into your Workspace, but when working on your own projects you can use the same process to import whole tables. It does not cost anything to add these samples to your Data Table, since you are not storing them in your own Workspace, only linking to them in another Workspace. Costs come into it when you start running analyses on the samples (as we will in a later exercise), so take care not to unintentionally run an expensive analysis on a large table of samples. Exercise 2. Modify the code in both cells to get 3 samples instead of 2, and run each cell. You should see a table listing out the samples appear below each cell. Confirm that there are 3 samples in each table. This step chose the samples we want from the original Workspace, but has not yet created links to them in your own Workspace. 7.3.5 Exported combined Data Table The next code block accomplishes a few things: bind_rows( \"AMR\"=df_sample_amr, \"EAS\"=df_sample_eas, .id=\"code\" ) combines data from the two different 1000 Genomes Workspaces into a single data table, so that you can conveniently work with all the data at once in your Workflows. It also adds a column named “code” to keep track of which samples came from the AMR vs. EAS datasets. select( sample_id, code, cram ) selects only the columns we care about for our analysis. Here we are keeping the sample ID, the superpopulation code (AMR or EAS) and the cram file. avtable_import( namespace=\"anvil-outreach\", name=\"shorts-combine-data-workspaces\" ) creates a Data Table in your Workspace that links to the original data, so that you can easily use it in your analyses. This is the line that we need to modify so that the Data Table is created in your Workspace. Exercise You will need two pieces of information so that the AnVIL package can locate your Workspace to create the new Data Table: The namespace (the Workspace’s Billing Project) The Workspace name You can find both of these at the end of the URL for your Workspace which is structured like this: anvil.terra.bio/#workspaces/namespace/name For example, for this Workspace: https://anvil.terra.bio/#workspaces/anvil-outreach/shorts-combine-data-workspaces_KCox_20230609 The namespace is anvil-outreach The name is shorts-combine-data-workspaces_KCox_20230609 3. Modify the code in your Notebook so that it points to your Workspace, and run the cell. If this command is successful, you will not see much output in the Notebook, but if you look in the Data tab of your Workspace you should now see the sample Data Table has 6 rows in it. 7.3.6 Session Info It’s generally a good idea to document information about the packages (and their versions) you used while running the analysis. The last codeblock uses the sessionInfo() command to do just that. 7.3.7 View your new Data Table As a last step, take a look at the Data Tab in your Workspace. You should now see a table named sample that contains 6 rows - 3 with code “EAS” and 3 with code “AMR”. Note that for this exercise we preloaded the Workspace with 4 samples - if you only see 4 rows then double check your Notebook: Did you remember to “Run” each code cell after you edited it? Did you change the number of samples to link from 2 to 3 for each table? Did you update the avtable_import command to point to your Workspace? If you run into any trouble, don’t worry! You can carry out the remaining exercises using the 4 samples we provided for you, and you can visit our community support forum at help.anvilproject.org with any questions. 7.4 Explore Dockstore Workflows Once you have set up Data Tables in your Workspace, you can analyze the data using Workflows. To introduce you to Workflows, we will first take a look at the AnVIL Workflows available through Dockstore. The Dockstore platform is a repository for scalable bioinformatics tools and workflows. You can find Workflows for AnVIL by clicking on the “Organizations” tab and searching for AnVIL. Here you can find many Workflows which you can import into your AnVIL Workspace to use in your own analyses. These Workflows are organized into collections to make them easier to find. Exercise Go to dockstore.org, find the AnVIL Organization, and take a look at the Workflows that are available. Q1. How many GATK4 workflows focus on CNVs? Now let’s take a look at the qc-analysis-pipeline, which we will be running on our data. Under the AnVIL Organization is a collection called “Quality Control Workflows”. Here you can find the qc-analysis-pipeline. Clicking on the name of the Workflow will bring you to a page with detailed information about the Workflow, including the .wdl files for the Workflow. From here, you can import the Workflow into your Workspace using the Launch button. Don’t do this right now, or, if you do, import it with a different name (not qc-analysis-pipeline) so you don’t overwrite the Workflow that already exists in your Workspace. There are some additional configuration steps that are needed to make sure the Workflow is set up properly to run on the desired files in your Workspace. For the sake of time, we have provided a preconfigured version of this Workflow in the Workspace you cloned. You can learn more about configuring Workflows in the Terra Documentation on Workflows. 7.5 Run qc-analysis-pipeline "],["scale-with-workflows-instructor-guide.html", "8 Instructor Guide 8.1 Timeline", " 8 Instructor Guide 8.1 Timeline "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
